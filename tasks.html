<script>
$(function () {
  $(".code-placeholder").each(function () {
    new Waypoint({
      element: this,
      continuous: false,
      handler: (function ($placeholder) {
        return function (dir) {
          $.ajax({
            type: 'GET',
            url: "/codeblock/{{Lang1}}/{{Lang2}}/" + $placeholder.data('task') + "/",
            success: function (html) {
              $placeholder.before($placeholder.find('h3'))
              $placeholder.replaceWith(html)
            },
            error: function () {
              $placeholder.remove()
              $placeholder.find('h3').remove()
            },
            complete: function () {
              if (location.hash) {
                var hash = location.hash
                location.hash = hash
              }
            }
          })
        }
      })($(this))
    })
  })
})
</script>

{{#Tasks}}
  <div class=code-placeholder data-task="{{Href}}">
    <h3 class=code-title id={{Href}}><a href="#{{Href}}">{{Name}}</a></h3>
  </div>
{{/Tasks}}
